Homework2
================
Yunjia Liu
2024-09-30

## Problem1

Input data and do using clean_names() to clean the data. Using select()
to choose the required columns. Specially when treating all the
route1~route11, I use the starts_with() function to simplify the
process. And then I use mutate to convert ‘entry’ from character to
logical variable.

``` r
nyctransit_df = 
  read_csv("./data/NYC_Transit_Subway_Entrance_And_Exit_Data.csv") |>
  janitor::clean_names() |>
  select(line, station_name, station_latitude, station_longitude, starts_with("route"), entry, vending, entrance_type, ada) |>
  mutate(entry = ifelse(entry == "YES", TRUE, FALSE))
```

    ## Rows: 1868 Columns: 32
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## chr (22): Division, Line, Station Name, Route1, Route2, Route3, Route4, Rout...
    ## dbl  (8): Station Latitude, Station Longitude, Route8, Route9, Route10, Rout...
    ## lgl  (2): ADA, Free Crossover
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

``` r
head(nyctransit_df)
```

    ## # A tibble: 6 × 19
    ##   line     station_name station_latitude station_longitude route1 route2 route3
    ##   <chr>    <chr>                   <dbl>             <dbl> <chr>  <chr>  <chr> 
    ## 1 4 Avenue 25th St                  40.7             -74.0 R      <NA>   <NA>  
    ## 2 4 Avenue 25th St                  40.7             -74.0 R      <NA>   <NA>  
    ## 3 4 Avenue 36th St                  40.7             -74.0 N      R      <NA>  
    ## 4 4 Avenue 36th St                  40.7             -74.0 N      R      <NA>  
    ## 5 4 Avenue 36th St                  40.7             -74.0 N      R      <NA>  
    ## 6 4 Avenue 45th St                  40.6             -74.0 R      <NA>   <NA>  
    ## # ℹ 12 more variables: route4 <chr>, route5 <chr>, route6 <chr>, route7 <chr>,
    ## #   route8 <dbl>, route9 <dbl>, route10 <dbl>, route11 <dbl>, entry <lgl>,
    ## #   vending <chr>, entrance_type <chr>, ada <lgl>

``` r
num_rows = nrow(nyctransit_df)
num_cols = ncol(nyctransit_df)
cat("The dataset has", num_rows, "rows and", num_cols, "columns.\n")
```

    ## The dataset has 1868 rows and 19 columns.

### Summary:

1.  Variables in the data:

- line: The subway line the station belongs to.
- station_name: Name of the station.
- station_latitude / station_longitude: Geographic coordinates of the
  station.
- routes1~routes11: Subway routes served by the station.
- entry: whether the entrance allows entry.
- vending: Whether the entrance has a vending machine.
- entrance_type: Type of entrance
- ada: whether the entrance is ADA compliant.

2.  Cleaning steps: After using clean_names() to rename the variables, I
    retained the relevant columns, converted the entry column to a
    logical variable, and inspected the data for consistency. The
    dataset contains 1868 rows and 19 columns. As far as I am concerned,
    the data is relatively neat because each row corresponds to an entry
    and each variable has a different value.

### Quesiton1

Number of distinct stations.

``` r
distinct_stations = nyctransit_df |>
  distinct(line, station_name)

num_distinct_stations <- nrow(distinct_stations)
cat("Number of distinct stations: ", num_distinct_stations, "\n")
```

    ## Number of distinct stations:  465

### Question2

Number of stations that are ADA compliant.

``` r
ada_compliant = nyctransit_df |>
  filter(ada == "TRUE") |>
  distinct(line, station_name)

num_ada_compliant = nrow(ada_compliant)
cat("Number of ADA compliant stations: ", num_ada_compliant, "\n")
```

    ## Number of ADA compliant stations:  84

### Quesiton3

Proportion of entrances without vending allow entrance.

``` r
no_vending_entry = nyctransit_df |>
  filter(vending == "NO") |>
  summarise(proportion_entry = mean(entry))

cat("Proportion of entrances without vending allow entrance: ", no_vending_entry$proportion_entry, "\n")
```

    ## Proportion of entrances without vending allow entrance:  0.3770492

### Question4

Reformat the dataset. Using mutate(across(…)) to convert all route
columns to characters so that all route1~route11 columns are characters.
Using pivot_longer to combine all route1~route11 columns into a single
“route_name” column and make the original column as “route_number”.(I am
bit confuse about the description)

``` r
# Use pivot_longer to combine all route1~route11 columns into a single "route" column

transit_reformat = nyctransit_df |>
  mutate(across(starts_with("route"), as.character)) |>
   pivot_longer(route1:route11, names_to = "route_number", values_to = "route_name", values_drop_na = TRUE)
head(transit_reformat)
```

    ## # A tibble: 6 × 10
    ##   line     station_name station_latitude station_longitude entry vending
    ##   <chr>    <chr>                   <dbl>             <dbl> <lgl> <chr>  
    ## 1 4 Avenue 25th St                  40.7             -74.0 TRUE  YES    
    ## 2 4 Avenue 25th St                  40.7             -74.0 TRUE  YES    
    ## 3 4 Avenue 36th St                  40.7             -74.0 TRUE  YES    
    ## 4 4 Avenue 36th St                  40.7             -74.0 TRUE  YES    
    ## 5 4 Avenue 36th St                  40.7             -74.0 TRUE  YES    
    ## 6 4 Avenue 36th St                  40.7             -74.0 TRUE  YES    
    ## # ℹ 4 more variables: entrance_type <chr>, ada <lgl>, route_number <chr>,
    ## #   route_name <chr>

Filter the dataset to find stations that serve the A train and count the
number of distinct stations serving the A train

``` r
a_train_stations = transit_reformat |>
  filter(route_name == "A") |>
  distinct(line, station_name)

num_a_train_stations = nrow(a_train_stations)
cat("Number of distinct stations serving the A train: ", num_a_train_stations, "\n")
```

    ## Number of distinct stations serving the A train:  60

Find the number of A train stations that are ADA compliant and count the
number of ADA compliant stations serving the A train.

``` r
ada_compliant_a_train = transit_reformat |>
  filter(route_name == "A") |>
  filter(ada == "TRUE") |>
  distinct(line, station_name)

num_ada_compliant_a_train = nrow(ada_compliant_a_train)
cat("Number of ADA compliant stations serving the A train: ", num_ada_compliant_a_train, "\n")
```

    ## Number of ADA compliant stations serving the A train:  17

## Problem2

Input the data.

``` r
mr_trash_wheel =
  read_excel("./data/202309_Trash_Wheel_Collection_Data.xlsx", sheet = "Mr. Trash Wheel", skip = 1, na = c("NA", ".", "")) |>
  janitor::clean_names() |>
  drop_na(dumpster)|>
  mutate(
    sports_balls = as.integer(round(sports_balls, 0)),  # Round and convert to integer
    trash_wheel = "Mr. Trash Wheel",
    year = as.integer(year))
```

``` r
# Read and clean Professor Trash Wheel sheet
prof_trash_wheel = read_excel("./data/202309_Trash_Wheel_Collection_Data.xlsx", 
                                sheet = "Professor Trash Wheel", 
                                skip = 1,  # Adjust based on where data starts
                                col_names = TRUE,
                                na = c("NA", ".", "")) |>
  janitor::clean_names() |>
  drop_na(dumpster)|>
  mutate(
    year = as.integer(year),
    trash_wheel = "Professor Trash Wheel"
  )

# Read and clean Gwynnda's data sheet
gwynnda_trash_wheel = read_excel("./data/202309_Trash_Wheel_Collection_Data.xlsx", 
                                   sheet = "Gwynnda Trash Wheel", 
                                   skip = 1,
                                   col_names = TRUE,
                                  na = c("NA", ".", "")) |>
  janitor::clean_names() |>
  drop_na(dumpster)|>
  mutate(
    year = as.integer(year),
    trash_wheel = "Gwynnda Trash Wheel"
  )

# Combine datasets into one tidy dataset
combined_trash_data <- bind_rows(mr_trash_wheel, prof_trash_wheel, gwynnda_trash_wheel)

# Check combined data
head(combined_trash_data)
```

    ## # A tibble: 6 × 15
    ##   dumpster month  year date                weight_tons volume_cubic_yards
    ##      <dbl> <chr> <int> <dttm>                    <dbl>              <dbl>
    ## 1        1 May    2014 2014-05-16 00:00:00        4.31                 18
    ## 2        2 May    2014 2014-05-16 00:00:00        2.74                 13
    ## 3        3 May    2014 2014-05-16 00:00:00        3.45                 15
    ## 4        4 May    2014 2014-05-17 00:00:00        3.1                  15
    ## 5        5 May    2014 2014-05-17 00:00:00        4.06                 18
    ## 6        6 May    2014 2014-05-20 00:00:00        2.71                 13
    ## # ℹ 9 more variables: plastic_bottles <dbl>, polystyrene <dbl>,
    ## #   cigarette_butts <dbl>, glass_bottles <dbl>, plastic_bags <dbl>,
    ## #   wrappers <dbl>, sports_balls <int>, homes_powered <dbl>, trash_wheel <chr>

``` r
# Dimensions of the combined dataset
cat("Number of observations in the combined dataset: ", nrow(combined_trash_data), "\n")
```

    ## Number of observations in the combined dataset:  845
